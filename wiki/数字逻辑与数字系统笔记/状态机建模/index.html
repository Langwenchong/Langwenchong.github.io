<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>Digit&Logic：状态机建模 - 雨中•学圃堂</title>

  
    <meta name="description" content="根据电路图导出状态机 有时候我们并不是事先了解到需求功能后设计电路图，而是在给定电路原理图的情况下推断电路的逻辑功能，也就是电路设计的逆过程。此时我们需要按照如下步骤进行：  检查电路，标明输入输出和状态位 写出次态方程和输出方程 列出状态表和输出表 删除不可达状态以简化状态表 给每个有效状态编码指定状态名称 用状态名称重写状态表和输出表 画出状态转换图 使用文字描述有限状态机的功能  下面我们">
<meta property="og:type" content="website">
<meta property="og:title" content="状态机建模">
<meta property="og:url" content="https://scholar.coolchong.cn/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E7%8A%B6%E6%80%81%E6%9C%BA%E5%BB%BA%E6%A8%A1/index.html">
<meta property="og:site_name" content="雨中•学圃堂">
<meta property="og:description" content="根据电路图导出状态机 有时候我们并不是事先了解到需求功能后设计电路图，而是在给定电路原理图的情况下推断电路的逻辑功能，也就是电路设计的逆过程。此时我们需要按照如下步骤进行：  检查电路，标明输入输出和状态位 写出次态方程和输出方程 列出状态表和输出表 删除不可达状态以简化状态表 给每个有效状态编码指定状态名称 用状态名称重写状态表和输出表 画出状态转换图 使用文字描述有限状态机的功能  下面我们">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425191332.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425191851.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425191819.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425191935.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425192148.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425192316.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425192401.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425193206.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425194707.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425195615.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425200125.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425200422.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425200822.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425202159.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425202424.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425202907.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425203401.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425203748.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425204642.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425205654.png">
<meta property="og:image" content="https://langwenchong.gitee.io/figure-bed/20210425210723.png">
<meta property="article:published_time" content="2023-01-27T14:29:35.114Z">
<meta property="article:modified_time" content="2023-01-27T14:29:35.114Z">
<meta property="article:author" content="Wenchong Lang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://langwenchong.gitee.io/figure-bed/20210425191332.png">
  
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="雨中•学圃堂" type="application/atom+xml">
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    <link rel="shortcut icon" href="https://cdn.coolchong.cn/%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5/langwenchong.png">
  

  

  
    <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    <script defer src="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" ></script>
    <script defer src="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
  


  
    
      <link href="https://fonts.font.im/css?family=Dancing+Script" rel="stylesheet">
    
      <link href="https://fastly.jsdelivr.net/gh/volantis-x/cdn-fontawesome-pro@master/css/all.min.css" rel="stylesheet">
    
  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='wiki'>
    

  




<div class="widgets"><widget class="widget-wrapper logo-wrap wiki"><div class="widget-body"><a style="filter: grayscale(100%)" class="wiki-home cap" href="/wiki"><svg aria-hidden="true" viewBox="0 0 16 16" width="1rem" height="1rem" fill="currentColor"><path fill-rule="evenodd" d="M7.78 12.53a.75.75 0 01-1.06 0L2.47 8.28a.75.75 0 010-1.06l4.25-4.25a.75.75 0 011.06 1.06L4.81 7h7.44a.75.75 0 010 1.5H4.81l2.97 2.97a.75.75 0 010 1.06z"></path></svg>所有笔记</a><a class="title" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9F%BA%E6%9C%AC%E5%85%83%E4%BB%B6/index.html"><div class="main" ff="title">Digit&Logic</div><div class="sub cap">这都不会怎么好意思称之为"科班生"？</div></a></div></widget>
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/wiki/数字逻辑与数字系统笔记/" placeholder="想找点什么？"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">好像并未找到什么！</div></div></div></widget>




<widget class="widget-wrapper toc multi" id="data-toc"><div class="widget-header cap dis-select"><span class="name">基础知识</span></div><div class="widget-body fs14"><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9F%BA%E6%9C%AC%E5%85%83%E4%BB%B6/index.html#start"><span class="toc-text">逻辑电路基本元件</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F/index.html"><span class="toc-text">逻辑电路的表达式</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80%E4%B8%8E%E4%B8%89%E6%80%81%E7%BC%93%E5%86%B2%E5%99%A8/index.html"><span class="toc-text">表达式化简与三态缓冲器</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%8D%A1%E8%AF%BA%E5%9B%BE%E4%B8%8E%E7%BC%96%E8%AF%91%E7%A0%81%E5%99%A8/index.html"><span class="toc-text">卡诺图与编译码器</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80/index.html"><span class="toc-text">硬件描述语言</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E8%A1%8C%E4%B8%BA%E5%BB%BA%E6%A8%A1/index.html"><span class="toc-text">行为建模</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%B3%95%E6%8B%93%E5%B1%95%E4%B8%8E%E6%B5%8B%E8%AF%95/index.html"><span class="toc-text">建模方法拓展与测试</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%B8%B8%E7%94%A8%E9%80%BB%E8%BE%91%E5%99%A8%E4%BB%B6/index.html"><span class="toc-text">常用逻辑器件</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF/index.html"><span class="toc-text">时序逻辑电路</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/index.html"><span class="toc-text">有限状态机</span></a></div><div class="doc-tree active"><a class="doc-tree-link active" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E7%8A%B6%E6%80%81%E6%9C%BA%E5%BB%BA%E6%A8%A1/index.html"><span class="toc-text">状态机建模</span></a><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E7%94%B5%E8%B7%AF%E5%9B%BE%E5%AF%BC%E5%87%BA%E7%8A%B6%E6%80%81%E6%9C%BA"><span class="toc-text"> 根据电路图导出状态机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Esystemverilog-hdl%E7%9A%84%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1"><span class="toc-text"> 基于SystemVerilog HDL的时序逻辑设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E5%BB%BA%E6%A8%A1"><span class="toc-text"> 寄存器建模</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81%E5%AD%98%E5%99%A8%E5%BB%BA%E6%A8%A1"><span class="toc-text"> 锁存器建模</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BB%E5%A1%9E%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5-vs-%E9%9D%9E%E9%98%BB%E5%A1%9E%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5"><span class="toc-text"> 阻塞赋值语句&#x3D; VS 非阻塞赋值语句&lt;&#x3D;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-text"> 赋值语句使用规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E6%95%B0%E5%99%A8%E5%BB%BA%E6%A8%A1"><span class="toc-text"> 计数器建模</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text"> 移位寄存器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA%E5%BB%BA%E6%A8%A1"><span class="toc-text"> 有限状态机建模</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%99%A8%E9%98%B5%E5%88%97"><span class="toc-text"> 存储器阵列</span></a></li></ol></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%AD%98%E5%82%A8%E5%99%A8%E5%BB%BA%E6%A8%A1/index.html"><span class="toc-text">存储器建模</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E6%8C%87%E4%BB%A4%E9%9B%86%E4%BD%93%E7%B3%BB/index.html"><span class="toc-text">指令集体系</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%8D%95%E5%91%A8%E6%9C%9FMIPS32/index.html"><span class="toc-text">单周期MIPS32</span></a></div></div></widget>



<widget class="widget-wrapper related"><div class="widget-header cap theme dis-select"><span class="name">更多计算机基础</span></div><div class="widget-body related-posts"><a class="item wiki" href="/wiki/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/index.html"><span class="title">操作系统笔记</span><span class="excerpt">操作系统是每一名计算机科班生都必会的基础内容之一，借着考研的机会我参考王道图书重新学习了操作系统并记录下了我的一些浅显理解。</span></a><a class="item wiki" href="/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/index.html"><span class="title">计算机组成原理笔记</span><span class="excerpt">计算机组成原理是每一名计算机科班生都必会的基础内容之一，借着考研的机会我参考王道图书重新学习了操作系统并记录下了我的一些浅显理解。</span></a><a class="item wiki" href="/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/%E4%BB%80%E4%B9%88%E6%98%AF%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html"><span class="title">计算机网络笔记</span><span class="excerpt">计算机网络是每一名计算机科班生都必会的基础内容之一，借着考研的机会我参考王道图书重新学习了操作系统并记录下了我的一些浅显理解。</span></a><a class="item wiki" href="/wiki/%E6%89%8B%E6%92%95%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/index.html"><span class="title">手撕算法笔记</span><span class="excerpt">程序=数据结构+算法,世界上最优秀的程序一定使用了最先进优雅的算法，让我们一同进入算法的世界中学习，感受编程的魅力吧！</span></a></div></widget>
</div>


    </aside>
    <div class='l_main'>
      

      

  
  
<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" id="home" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" id="menu" href="/wiki/">笔记</a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9F%BA%E6%9C%AC%E5%85%83%E4%BB%B6/index.html">Digit&Logic</a></div><div id="post-meta">更新于&nbsp;<time datetime="2023-01-27T14:29:35.114Z">2023-01-27</time></div></div>

  <article class='md-text content wiki reveal'>
  <h1 class="article-title"><span>状态机建模</span></h1>
  <h3 id="根据电路图导出状态机"><a class="markdownIt-Anchor" href="#根据电路图导出状态机"></a> 根据电路图导出状态机</h3>
<p>有时候我们并不是事先了解到需求功能后设计电路图，而是在给定电路原理图的情况下推断电路的逻辑功能，也就是电路设计的逆过程。此时我们需要按照如下步骤进行：</p>
<ol>
<li>检查电路，标明输入输出和状态位</li>
<li>写出次态方程和输出方程</li>
<li>列出状态表和输出表</li>
<li>删除不可达状态以简化状态表</li>
<li>给每个有效状态编码指定状态名称</li>
<li>用状态名称重写状态表和输出表</li>
<li>画出状态转换图</li>
<li>使用文字描述有限状态机的功能</li>
</ol>
<p>下面我们用一个案例来学习根据电路原理图导出状态机：如下图是一个键盘锁电路，包含两个输入和一个输出，当输出为1时表示开锁成功，试分析，如何进行输入才能使电路产生开锁信号</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425191332.png" alt="" /></p>
<p>首先我们要检查电路图，标明输入，输出和状态位：</p>
<ul>
<li>输入A0,A1</li>
<li>输出unlock</li>
<li>状态位S0,S1</li>
<li>电路的输出只取决于状态位Unlock=S1</li>
<li>很明显这个电路使用个Moore型状态机</li>
</ul>
<p>接下来我们写出次态和输出的计方程：</p>
<p>观察上面的电路图，我们可以直接对照着写出次态的计算方程</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>S</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>S</mi><mn>0</mn><mover accent="true"><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true">‾</mo></mover><msub><mi>A</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>S</mi><mn>0</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mover accent="true"><mrow><msub><mi>S</mi><mn>1</mn></msub><msub><mi>S</mi><mn>0</mn></msub></mrow><mo stretchy="true">‾</mo></mover><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
S_1&#x27;=S0\overline{A_1}A_0\\
S_0&#x27;=\overline{S_1S_0}A_1A_0
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>同样输出的计算方程我们也可以轻松推得：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>U</mi><mi>n</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Unlock=S_1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>接下来我们要根据上面的方程枚举所有的情况列出状态表和输出表：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425191851.png" alt="" /></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425191819.png" alt="" /></p>
<p>然后我们将状态表填写完整，进行不可达状态的删除：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425191935.png" alt="" /></p>
<p>我们发现状态S1:0=11从未在表中作为次态出现过，即无论输入A1,A0取何值都不可能计算得到次态的11，因此将状态表和输出表对应不可达状态S1:0=11的一栏删除。同时对于现态S1:0=10，总是得到次态S1:0=00，因此此时与输入无关，可以使用无关项X来进一步化简。最终我们得到化简后的状态表和输出表如下图：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425192148.png" alt="" /></p>
<p>接下来我们为状态表和输出表中的每一个有效状态编码指定状态名称，从而使得更容易知道输入情况同时也方便后面进行状态转换图的绘制：</p>
<p>我们规定有效状态编码对应的名称如下图：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425192316.png" alt="" /></p>
<p>因此将上面的化简后的两个表使用新的名称来表示：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425192401.png" alt="" /></p>
<p>此时我们根据已经用状态名称标注的状态表和输出表进行状态转换图的绘制，要注意因为是Moore型状态转换机，因此输出应该是写在状态圆圈的内部的。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425193206.png" alt="" /></p>
<p>最后我们再观察状态转换图，进行以下逻辑整理，便可以描述出这个电路图要实现的功能了，如上图，在复位状态下，只有先后输入了3和1才能到达解锁状态S2，这也就说明这个键盘输入锁的密码就是31。</p>
<h3 id="基于systemverilog-hdl的时序逻辑设计"><a class="markdownIt-Anchor" href="#基于systemverilog-hdl的时序逻辑设计"></a> 基于SystemVerilog HDL的时序逻辑设计</h3>
<p>前面我们学习了使用建模语言设计组合逻辑电路，那么接下来我们来学习使用SystemVerilog HDL来设计时序逻辑电路。首先我们需要注意SystemVerilog使用一些特殊的编码风格（IDIOMS)描述锁存器、触发器和状态机。其他的编码风格虽然可以正确的进行仿真，但是综合后会产生错误的电路。</p>
<p>这里我们学习一下如何使用always过程块进行时序逻辑电路的建模:</p>
<p>always过程块分为三类：</p>
<ul>
<li>always_comb(描述组合逻辑)</li>
<li>always_latch</li>
<li>always_ff</li>
</ul>
<p>其中后面两个都是描述时序逻辑电路的声明语句。always过程块结构：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(sensitivity list)</span><br><span class="line"> 		statements;</span><br></pre></td></tr></table></figure>
<p>sensitivity list是敏感事件列表，当列表中的事件产生时，过程块的语句就开始工作。下面我们就来用几个实例来具体学习一下使用always过程块进行时序逻辑器件的建模。</p>
<h3 id="寄存器建模"><a class="markdownIt-Anchor" href="#寄存器建模"></a> 寄存器建模</h3>
<p>寄存器是一个典型的时序逻辑器件，他在同一时刻更新存储多位信息。其结构如下：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425194707.png" alt="" /></p>
<p>那么我们的建模代码如下</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> flop(<span class="keyword">input</span> <span class="keyword">logic</span> clk,</span><br><span class="line">			<span class="keyword">input</span> <span class="keyword">logic</span>[<span class="number">3</span>:<span class="number">0</span>] d,</span><br><span class="line">			<span class="keyword">output</span> <span class="keyword">logic</span>[<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">		<span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">			q&lt;=d;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>我们使用正边沿D触发器来实现这个寄存器的功能，always_ff用来表示触发器，@后面括号中的posedge clk就是敏感事件，其实就是时刻监视clk，即clk就是时序逻辑电路的条件，当满足时就执行内部的代码，posedge clk表示信号上升沿有效，因此当clk处于有效上升沿时，q的更新赋予d的值。其中这里的赋值符号不是=，而是&lt;=，这在前面其实将结果是非阻塞赋值的意思，这里我们还不用深究，暂时可以把它视为普通的赋值语句。</p>
<p>那么接下来我们来尝试为这个寄存器增添一个复位端，使其能够恢复到最初始的状态。我们前面学到了复位有两种方式：</p>
<ul>
<li>同步复位：只有在clk处于上升沿时可以进行复位</li>
<li>异步复位：只要reset=1，那么无论是clk是否处于上升沿都可以强制进行复位，也就是说只要reset处于有效沿，那么就可以执行复位代码。</li>
</ul>
<p>这里我们给出两种不同复位方式的寄存器建模代码：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425195615.png" alt="" /></p>
<p>我们可以看到对于同步复位功能的寄存器，他的敏感事件只有clk，因此只有clk处于有效沿时才能执行always内部的代码，因此只有在clk有效时才可能进行reset的判断以及复位。但是对于异步复位的寄存器，敏感事件有两个即新增了一个reset，也就是说此时只要reset或者clk处于有效沿，都可以执行过程块内部的语句，因此此时是异步复位。</p>
<div class="tag-plugin note" color="yellow"><div class="title">一定要注意senitivity</div><div class="body"><p>list只要有一个事件满足就可以进行过程块下的代码，因此条件之间是或的关系</p></div></div> 
<p>进一步我们还可以为具有复位功能的寄存器添加一个使能端，只有使能端en=1时才能将Q更新为采样的输入值D：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425200125.png" alt="" /></p>
<h3 id="锁存器建模"><a class="markdownIt-Anchor" href="#锁存器建模"></a> 锁存器建模</h3>
<p>接下来我们再来实现以下锁存器的建模，实际上并不是所有的综合工具都能够很好地支持锁存器，除非你能明确的知道那些工具支持锁存器，否则最好不要优先使用锁存器，而是使用边沿触发器来替代。同时我们还要防止HDL意外生成锁存器。</p>
<p>我们思考一下锁存器的功能，实际上就是只有在clk=1有效状态时，才能让Q时刻跟随采样的输入值D变化，否则就维持之前的值。因此建模代码很简单：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425200422.png" alt="" /></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> latch(<span class="keyword">input</span> <span class="keyword">logic</span> clk,</span><br><span class="line">			<span class="keyword">input</span> <span class="keyword">logic</span>[<span class="number">3</span>:<span class="number">0</span>] d,</span><br><span class="line">			<span class="keyword">output</span> <span class="keyword">logic</span>[<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">		<span class="keyword">always_latch</span></span><br><span class="line">			<span class="keyword">if</span>(clk) q&lt;=d;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="阻塞赋值语句-vs-非阻塞赋值语句"><a class="markdownIt-Anchor" href="#阻塞赋值语句-vs-非阻塞赋值语句"></a> 阻塞赋值语句<code>=</code> VS 非阻塞赋值语句<code>&lt;=</code></h3>
<p>我们前面学习过非阻塞赋值语句和阻塞赋值语句区别：</p>
<ul>
<li><code>&lt;=</code>是非阻塞赋值语句，他的特点是可以和其他的语句同时执行</li>
<li><code>=</code>是阻塞赋值语句，他的特点是按照语句的在代码中的顺序依次工作</li>
</ul>
<p>但是当时我们很难理解两者的应用上有何异同，接下来我们使用一个案例来分析一下：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425200822.png" alt="" /></p>
<p>我们发现上面的两个建模代码很相似，只是在赋值的时候使用了不同的赋值语句，最终对应的电路图有很大的区别，这就是非阻塞赋值语句和阻塞赋值语句造成的。首先我们分析一下左侧使用非阻塞赋值语句的建模代码，由于非阻塞赋值语句是并行执行的，而不是阻塞式的串行，因此上面两个赋值代码是同时执行的，也就是说q被赋予的是n1还没被更新成d的值。举个例，假设初始时n1=0,d=1，那么执行上面的非阻塞赋值语句后n1=1,q=0，我们发现q的值是n1之前的值0，而不是被更改为d后的1值，这是因为n1和q同时更新值，从q的视角来看，此时n1还是0值，只有当q更新为0以后n1才变成了新的值1。</p>
<p>而阻塞赋值语句就很好理解了，就是我们通常意义上的与C和java等高级软件编程语言都类似的串行赋值，因此n1先更新成了1，然后q才被赋予了n1的值也就是1，因此对于右侧阻塞赋值语句最终的结果q=n1=1。</p>
<p>我们发现正是这两种不同的赋值语句导致了最终实现的电路图是不同的，左侧最终实现的是两个串联的D触发器，而右侧的是一个D触发器。我们还可以进一步尝试将左侧的非阻塞赋值语句用阻塞赋值语句来表示：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面两个代码是等同效果的</span></span><br><span class="line">n1&lt;=d;</span><br><span class="line">q&lt;=n1;</span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line">q=n1;</span><br><span class="line">n1=d;</span><br></pre></td></tr></table></figure>
<h3 id="赋值语句使用规则"><a class="markdownIt-Anchor" href="#赋值语句使用规则"></a> 赋值语句使用规则</h3>
<p>因此我们可以对各种建模方式的赋值语句进行一个总结：</p>
<p>当使用同步时序逻辑电路要使用always_ff @(posedge clk)和非阻塞赋值语句是代码如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">	q&lt;=d;</span><br></pre></td></tr></table></figure>
<p>而当对于简单的组合逻辑电路中可以使用赋值语句assign</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assign</span> y=a&amp;b;</span><br></pre></td></tr></table></figure>
<p>而对于使用always_comb和阻塞赋值语句=的描述复杂组合逻辑电路的语句如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">	p=a^b;</span><br><span class="line">	g=a&amp;b;</span><br><span class="line">	s=p^cin;</span><br><span class="line">	cout=g|(p&amp;cin)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<div class="tag-plugin note" color="yellow"><div class="body"><p>注意不要在多于1个always语句块或者连续赋值语句中对同一个信号赋值</p></div></div> 
<h3 id="计数器建模"><a class="markdownIt-Anchor" href="#计数器建模"></a> 计数器建模</h3>
<p>N位二进制计算器如下图：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425202159.png" alt="" /></p>
<p>他的输入有时钟信号clk,复位信号reset，同时输出就是一个N位二进制计数结果。功能是每次在时钟上升沿到达时将结果加1并输出。能够实现循环计数：000,001,010，…。因此这是一个时序逻辑器件，他常用数字时钟和程序计数器（PC）中。</p>
<p>下面我们来对他进行建模：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425202424.png" alt="" /></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> counter <span class="variable">#(paramer N=8)</span></span><br><span class="line">				(<span class="keyword">input</span> <span class="keyword">logic</span> clk,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">logic</span> reset,</span><br><span class="line">				<span class="keyword">output</span> <span class="keyword">logic</span> [N-<span class="number">1</span>:<span class="number">0</span>] q);</span><br><span class="line">		<span class="comment">//很明显是异步复位</span></span><br><span class="line">		<span class="keyword">always_ff</span> @(<span class="keyword">posedge</span> clk,<span class="keyword">posedge</span> reset)</span><br><span class="line">		<span class="keyword">if</span>(reset)q&lt;=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> q&lt;=q+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>注意上面的赋值语句虽然使用阻塞赋值语句也不会有问题（这是因为每种情况只会有一个赋值代码），但是为了规范可以在任何综合工具上都能综合，因此还是要求使用<code>&lt;=</code>来进行赋值。</p>
<h3 id="移位寄存器"><a class="markdownIt-Anchor" href="#移位寄存器"></a> 移位寄存器</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425202907.png" alt="" /></p>
<p>移位寄存器输入有时钟信号clk,串行输入信号Sin,输出由串行输出Sout以及N位并行输入的Qn-1:0。移位寄存器的功能就是在时钟信号的每一个上升沿，从Sin移入一个新的位，并将寄存器的整体向前（高位）移动一位，因此最前面（最高位）会出来位移如Sout。我们可以将其看成是一个串行到并行的转换器，每一个周期从Sin输入一位，N个周期后可以通过Qn-1:0直接访问N位输入。因此在将内容整体移位时很明显是需要并行同时执行赋值更新操作的，因此是用非阻塞赋值语句的同步时序逻辑来实现，使用的实现器件就是将N个D触发器串联即可。</p>
<p>下面我们对这个移位寄存器进行优化，使其可以并行加载，什么意思？</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425203401.png" alt="" /></p>
<p>此时输入增加了Load信号和并行输入信号Dn-1:0。我们思考一下，之前如果我们想要先将这个N位寄存器加载一个N位数，那么需要先执行N次移位操作，才能将这个N为二进制码加载进去，这很麻烦，因此使用并行输入信号同一时刻并行的为每一个位进行赋值从而实现单位时间不用移位就完成移位寄存器对于一个N为二进制数的加载。此时功能是：</p>
<ul>
<li>Load=1时，并行加载一个N位二进制数</li>
<li>Load=0时，移位寄存器进行移位操作，每一次clk上升沿整体向高位移动一次，最低位由Sin填入</li>
</ul>
<p>那么此时可以实现串行转并行：Sin到Qn-1:0，同时还有并行转串行Dn-1:0到Sout。那么此时我们来实现一个建模：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425203748.png" alt="" /></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> shiftreg #(<span class="keyword">parameter</span> N=<span class="number">8</span>)</span><br><span class="line">				(<span class="keyword">input</span> <span class="keyword">logic</span> clk,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">logic</span> reset,load,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">logic</span> sin,</span><br><span class="line">				<span class="keyword">input</span> <span class="keyword">logic</span> [N-<span class="number">1</span>:<span class="number">0</span>] q,</span><br><span class="line">				<span class="keyword">output</span> <span class="keyword">logic</span> [N-<span class="number">1</span>:<span class="number">0</span>] q,</span><br><span class="line">				<span class="keyword">output</span> <span class="keyword">logic</span> sout);</span><br><span class="line">		<span class="comment">//很明显又是一个异步复位</span></span><br><span class="line">		<span class="keyword">always_ff</span> @(psoedge clk,<span class="keyword">posedge</span> reset)</span><br><span class="line">			<span class="comment">//复位</span></span><br><span class="line">			<span class="keyword">if</span>(reset)q&lt;=<span class="number">0</span>;</span><br><span class="line">			<span class="comment">//同时并行赋值同一时刻完成N位二进制数的加载</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(load)q&lt;=d;</span><br><span class="line">			<span class="comment">//移位，注意要将sin拼接到最低位</span></span><br><span class="line">			<span class="keyword">else</span> q&lt;=&#123;q[N-<span class="number">2</span>],sin&#125;;</span><br><span class="line">			<span class="comment">//同时记录sout值</span></span><br><span class="line">			<span class="keyword">assign</span> sout=q[N-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="有限状态机建模"><a class="markdownIt-Anchor" href="#有限状态机建模"></a> 有限状态机建模</h3>
<p>我们之前学习的建模都是只是将最核心的同步时序电路部分进行了建模，使用的是always_ff实现的，但是实际上对于一个状态机来说，他在状态寄存器的两侧还存在输入到现态的计算的组合逻辑电路，还有右侧连接的根据现态计算出输出的组合逻辑电路，因此实际上在对一个有限状态机进行建模时即需要alwalys_ff的同步时序过程块，也需要alwyas_comb组合逻辑过程块。如下：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425204642.png" alt="" /></p>
<p>这是一个最简单的3分频计数器，他就是一个moore型的有限状态机，输入是一个时钟输入信号，一个输出，功能是每3个周期后输出产生一个周期的高电平。因此状态转换图如上图，输出是时钟的3分频。因此建模代码如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> divideby3FSM(<span class="keyword">input</span> <span class="keyword">logic</span> clk,</span><br><span class="line">					<span class="keyword">input</span> <span class="keyword">logic</span> reset,</span><br><span class="line">					<span class="keyword">output</span> <span class="keyword">logic</span> q);</span><br><span class="line">	<span class="comment">//枚举类型集合的声明,类似于结构体的声明</span></span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">enum</span> <span class="keyword">logic</span> [<span class="number">1</span>:<span class="number">0</span>] &#123;S0,S1,S2&#125; statetype;</span><br><span class="line">	<span class="comment">//statetype枚举集合的实例化</span></span><br><span class="line">	statetype [<span class="number">1</span>:<span class="number">0</span>] state,nextstate;</span><br><span class="line">	<span class="comment">//核心状态寄存器使用同步时序逻辑</span></span><br><span class="line">	<span class="keyword">always_ff</span> @ (<span class="keyword">posedge</span> clk,<span class="keyword">posedge</span> reset)</span><br><span class="line">		<span class="keyword">if</span>(reset) state&lt;=S0;</span><br><span class="line">		<span class="keyword">else</span> stats&lt;=nextstate;</span><br><span class="line">	<span class="comment">//次态的计算使用次态组合逻辑计算</span></span><br><span class="line">	<span class="keyword">always_comb</span></span><br><span class="line">		<span class="keyword">case</span>(state)</span><br><span class="line">			S0:nextstate=S1;</span><br><span class="line">			S1:nextstate=S2;</span><br><span class="line">			S2:nextstate=S0;</span><br><span class="line">			<span class="keyword">default</span>:nextstate=s0;</span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="comment">//输出逻辑</span></span><br><span class="line">	<span class="keyword">assign</span> q=(state==S0);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>我们会发现上面又添加了两个组合逻辑过程块分别同来计算输入到次态和现态到输出，同时由于SystemVerilog HDL硬件语言具有并行性的特点，因此nextstate虽然先在always_ff的同步时序逻辑过程块中使用了，但是其具体值其实是通过下面的次态组合逻辑过程块计算得到的。</p>
<div class="tag-plugin note" color="yellow"><div class="title">一定要注意SystemVerilog</div><div class="body"><p>HDL的代码具有并行性的特点，因此信号的调用和声明赋值无先后顺序。</p></div></div> 
<h3 id="存储器阵列"><a class="markdownIt-Anchor" href="#存储器阵列"></a> 存储器阵列</h3>
<p>接下来我们学习一个重要的器件–存储器阵列，他是一种有效的可以存入大量数据的模块，每一个N位地址都可以读出或者写入M为数据。</p>
<ul>
<li>数据：存储的内容</li>
<li>地址：数据的索引</li>
</ul>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425205654.png" alt="" /></p>
<p>存储器由一个二维存储单元阵列构成，每一各位单元存储一位数据，每一行存储的是一个M位二进制码数据，由于地址编码是N为，因此一共有2^N行，也就是说可以存储2^N个M位二进制码数据。</p>
<p>对一个N位地址M位数据的阵列：</p>
<ul>
<li>有2^N行和M列</li>
<li>深度（Depth)：阵列的行数</li>
<li>宽度（Width)：阵列的列数</li>
<li>阵列的总大小（Array Size)：深度×宽度=2^N×M</li>
<li>字（Word)：每行数据成为一个字</li>
</ul>
<p>例如一个2位地址和3位数据的存储器阵列：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://langwenchong.gitee.io/figure-bed/20210425210723.png" alt="" /></p>
<p>他的阵列深度会是4行，同时数据字个数也就是4个，每一个字的字长是3位。如上图所示，10地址存放的数据就是100。</p>

  


  </article>
  
<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">回顾上一篇</div><a href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/index.html">有限状态机</a></div><div class="item" id="next"><div class="note">接下来阅读</div><a href="/wiki/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/%E5%AD%98%E5%82%A8%E5%99%A8%E5%BB%BA%E6%A8%A1/index.html">存储器建模</a></div></section></div>

  

  <div class='related-wrap md-text reveal' id="comments">
    <section class='header cmt-title cap theme'>
      快来参与讨论吧
    </section>
    <section class='body cmt-body waline'>
      

<div id="waline_container" class="waline_thread" comment_id="DigitLogic"><svg class="loading" style="vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>

    </section>
  </div>




      
<footer class="page-footer reveal fs12"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs14">博客</span><a href="/">随想录</a><a href="/intro">言堂序</a><a href="/archives">归档册</a></div><div class="sitemap-group"><span class="fs14">笔记</span><a href="/wiki/tags/%E7%AC%AC%E4%B9%9D%E8%89%BA%E6%9C%AF">第九艺术</a><a href="/wiki/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80">计算基础</a><a href="/wiki/tags/%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80">语言基础</a><a href="/wiki/tags/%E8%BF%9B%E9%98%B6%E6%8A%80%E8%83%BD">进阶技能</a></div><div class="sitemap-group"><span class="fs14">便笺</span><a href="/notes/%E7%A7%91%E7%A0%94%E5%AD%A6%E4%B9%A0">科研学习</a><a href="/notes/%E5%BB%BA%E7%AB%99%E5%BF%85%E5%A4%87">建站必备</a><a href="/notes/%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7">建站必备</a></div><div class="sitemap-group"><span class="fs14">更多</span><a href="/dennounce">隐私政策</a><a href="/">友情链接</a></div></div><div class="text"><div class="github-badge">
  <a style="color: #fff"  href="https://coolchong.cn/" target="_blank" title="由 Langwenchong 搭建运营">
    <span class="badge-subject">Built</span><span class="badge-value bg-blue">雨中 @2022-2023</span>
  </a>
  <a style="color: #fff" href="https://cloud.tencent.com/" target="_blank" title="静态资源托管于 七牛云" >
    <span class="badge-subject">Powered</span><span class="badge-value bg-orange">七牛云</span>
  </a>
  <a style="color: #fff" href="https://xaoxuu.com/wiki/stellar/" target="_blank" title="站点使用 Stellar 主题" >
    <span class="badge-subject">Theme</span><span class="badge-value bg-brightgreen">Stellar</span>
  </a>
  <a style="color: #fff" href="https://beian.miit.gov.cn/)" target="_blank" title="网站已备案授权开放">
    <span class="badge-subject">Record</span><span class="badge-value bg-red">津ICP备2021009044</span>
  </a>
</div>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.18.5';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->

  <script>
  function load_comment(){
    if(!document.getElementById("waline_container"))return;
    stellar.loadCSS('https://unpkg.com/@waline/client@2.14.1/dist/waline.css');
    stellar.loadScript('https://unpkg.com/@waline/client@2.14.1/dist/waline.js', {defer:true}).then(function () {
      const el = document.getElementById("waline_container");
      var path = el.getAttribute('comment_id');
      if (!path) {
        path = decodeURI(window.location.pathname);
      }
      Waline.init(Object.assign({"js":"https://unpkg.com/@waline/client@2.14.1/dist/waline.js","css":"https://unpkg.com/@waline/client@2.14.1/dist/waline.css","serverURL":"https://waline.coolchong.cn","commentCount":true,"pageview":false,"emoji":["https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/","https://unpkg.com/@waline/emojis@1.1.0/tw-emoji","https://unpkg.com/@waline/emojis@1.1.0/bilibili","https://unpkg.com/@waline/emojis@1.1.0/alus","https://unpkg.com/@waline/emojis@1.1.0/bmoji"],"locale":{"reactionTitle":null,"placeholder":"任何想法畅所欲言，记得填写邮箱方便及时收到回复哦~"},"reaction":["https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatheart.png","https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatattentionreverse.png","https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatrainbow.png","https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatwave.png","https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/blobcatalt.png","https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/blobcatscared.png"]}, {
        el: '#waline_container',
        path: path,
      }));
    });
  }
  window.addEventListener('DOMContentLoaded', (event) => {
    console.log('DOM fully loaded and parsed');
    load_comment();
  });

</script>




<!-- inject -->


  </div>
</body>
</html>
