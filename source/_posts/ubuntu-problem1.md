---
title: ubuntu报错:Starting User Manager for UID 121解决办法
comments: false
top: false
date: 2021-01-21 17:24:10
tags: [ubuntu]
categories: 
	- [知识分享,踩坑日志]
headimg: https://langwenchong.gitee.io/figure-bed/20210704160701.png
---

### 📝问题描述

在出现这个问题之前通常会出现一些磁盘分区空间不足的报错，然后如果持续性忽视此问题最终就很可能导致这种情况出现，在上一次开机还在正常的情况下本次开机并且以后所有开机ubuntu都会出现黑屏疯狂出现Starting User Manager for UID XX等信息无法进入ubuntu桌面进行操作。

<!-- more -->

### ❌问题出现前兆

一般是出现问题之前会经常出现以下情况的警告：

![](https://langwenchong.gitee.io/figure-bed/20210121173315.png)

![](https://langwenchong.gitee.io/figure-bed/20210121173435.png)

这些都是在提示空间磁盘分配不足时的提醒，但是由于操作者接收到警报后并未及时处理而是连续选择ignore忽视，最终导致的磁盘爆满由于无法为ui界面进程分配磁盘空间而导致无法显示桌面，所以会一直尝试为进程分配空间导致以下情况的报错。

### ❗问题截图及分析

![](https://langwenchong.gitee.io/figure-bed/84a4ca5a1d3c91e3d121647c29ef78a.png)

一般等待稳定后就会出现上图的情况，类似的还有UID 73等都是磁盘无额外空间导致无法正常运行图形界面进程导致的无法显示桌面进行操作。但是不用过于慌张，此时系统只是处于无法显示桌面进程的状态，存储在虚拟机中的文件系统并未被破坏。

✅问题解决办法

首先我们需要启动无桌面显示的操作命令行形式进行操作。所以首先待出现上面这种图稳定后同时按住ctrl+alt+f2或者ctrl+alt+f3（如果你使用的是另一种需要按住fn键触发的快捷键格式，那么需要按ctrl+alt+fn+f2或者ctrl+alt+fn+f3），duck不必害怕，按不坏。然后就进入到了命令行格式的操作界面了，需要输入你的账号和密码来登录，账号就是@之前的名字例如：

![](https://langwenchong.gitee.io/figure-bed/QQ图片20210121175121.png)

那么账号就是lwc，请务必能够登陆，否则请另寻他法。登陆以后我们首先检查磁盘分区的空间情况，请输入以下指令：

```linux
df -h
```

然后会出现磁盘空间的分布情况：

![](https://langwenchong.gitee.io/figure-bed/0ef4ef7c88d191790b3b368a506e871.png)

我们可以看出/dev/sda1的使用率已经达到了100%，无可用空间，这就是打不开桌面额原因，至于下方的loop都是100%是正常现象，不用管。如果你担心自己的文件能否丢失了，可以先用cd和ls指令查看自己的文件存储情况，一般没有损坏现象。那么接下来我们的任务就非常简单了，目的只有一个---删除不必要的文件腾出磁盘空间来能够启动桌面进程。当然这里我先声明一下，我想你一定是很着急解决此问题，你也肯定是搜索了许多的教程发现大多效果不佳或者废话连篇不能够立即解决，我推荐最好的方法就是重装虚拟机，没有别的什么神技方法，磁盘扩容在挂载（甚至还需要先下载一个Gparted软件）都是纸上谈兵，归根结底现在就是硬盘空间太少导致出现这种错误，我现在要讲解的方法是以打开桌面为目标并且尽可能帮助你先把需要亟待解决的文件导出到主机。

### 🚩操作方法

#### 目标一：保护本地文件不被误删

我想你大概是在做什么空间很大的代码项目所以现在眼前的第一任务就是保护此项目文件不被破坏能够导出或者保存。所以首先我们要将你的重要文件保护，这里推荐的方法就是使用github，将需要保存的文件保存至git这样即使误删了也可以通过clone恢复，同时你也可以通过github将文件先保存至主机。所以在命令行的情况下你是可以使用git进行文件上传的，如果你还不会上传，那么我强烈推荐你先学习一下git在进行操作。如果你有共享文件夹那更好，直接将重要文件移动到共享文件夹中导出到主机存放。当然如果你不想做这些准备工作，就想冒险也未尝不可。

#### 目标二：删除没必要的文件

那么将重要的文件保存到了github上以后我们现在要做的就是删除部分没必要的文件。首先我们先不要删除自己的文件，而是选择清理一下临时缓存文件。这里可以输入以下几个命令（我保证不会损坏你的文件系统）：

```c
//指令1:清理旧版本的软件缓存
sudo apt-get autoclean
//指令2：清理所有软件缓存
sudo apt-get clean
//指令3：删除系统不再使用的孤立软件
sudo apt-get autoclean
```

运行完这三个指令以后请再次输入df -h查看磁盘空间，重点查看sda x分区可用空间。一般用完上面这三个你大概率只是腾出了几百K或者几M的可用空间显然还是不够用，你需要继续进行磁盘空间清理。那么接下来你可以尝试删除一些很久以前用到的现在不用的旧文件或者图片，word，压缩包等，再次查看磁盘空间，如果很幸运可用空间拓展到了100M，那么就可以尝试重启虚拟机了一般就可以正常进入了。

#### 目标三：删除系统log日志

如果很不幸即使执行完上述操作你仍然无很多的可用空间，那么接下来就要尝试进行一些有风险的操作了。在操虚拟机的文件系统中存储有许多记录bug处理情况的日志以便操作系统能够及时对于已经记录过的再次发生的错误进行快速处理的log日志或者中间暂存的tmp文件，接下来我们就尝试删除这些文件了。你需要先输入

```
cd ..
```

一直重定向到/根目录下然后输入ls

![](https://langwenchong.gitee.io/figure-bed/20210121185617.png)

我们可以看到有以下几个文件夹，当然啦不用想肯定都是很重要的系统文件夹不能够乱动的，但是现在没办法，只能够尝试删除了。我们先了解一下几个文件夹的作用（不想看跳过也行，只要一会误删了不能启动了自己负责）：

| 文件夹名称 |                             作用                             |
| :--------: | :----------------------------------------------------------: |
|    bin     | 系统启动需要的命令和大部分普通用户平常所需的可执行命令。这个文件夹中的文件都是二进制的，权限很高，绝大部分文件普通用户都只有执行权限，无读写权限。 |
|    boot    | 存放Ubuntu内核文件及引导加载器bootstraploade相关的文件，如果这个目录中的文件被破坏，一般都会出现启动引导异常，无法正常进入系统。 |
|   cdrom    |       光盘目录,存储来自光盘的内容，现在基本上被淘汰了        |
|    dev     |          设备列表文件夹，设备包括鼠标、键盘、硬盘等          |
|    etc     | 程序的配置文件目录，vi编辑器的配置文件就在这个文件内，同时还存储着各个不同用户的密码，权限极高需要root |
|    home    |                    存储账户自己的个人文件                    |
|    lib     | 各种程序所需的共享动态链接库，是系统程序能正常运行的支持文件。 |
|   lib32    |                        系统32位支持库                        |
|   lib64    |                        lib64位支持库                         |
|   media    |                 存放所有关于媒体信息的文件。                 |
|    mnt     |        所有挂载系统中设备，当然共享文件夹也存放在这里        |
|    proc    | 存储的是系统信息和进程信息。记录着系统运行的绝大多数进程的参数 |
|    root    |                     超级管理员的文件目录                     |
|    run     |           保存从系统诞生到当前的关于系统信息的文件           |
|    sbin    |            存储的是管理员可执行的命令，二进制文件            |
|    snap    |                    snap应用框架的程序文件                    |
|    srv     |                    系统存储的服务相关数据                    |
|    sys     |                   系统中文件的层次结构记录                   |
|    tmp     |               存放系统或者用户的临时文件的目录               |
|    usr     |                     和用户相关的文件系统                     |
|    var     |               存放类似日志这样随时间变化的文件               |
| initrd.img |       临时引导系统到内核文件的镜像文件。不能随便删除。       |

所以我们优先删除tmp和var，但是尤其要注意能少删除就少删除，并且不是直接删除这个文件夹，而是清空这个文件夹的内容。如下：

如果我们要删除tmp文件夹内的内容那么是输入：

```
rm -rf tmp/*
```

如果删除完这个后磁盘空间有>=60M的空间那么就可以尝试重启虚拟机了应该就可以正常进入了。如果很不幸你还是不能正常启动那么我们就继续尝试删除，进入var文件夹查看：

```c
cd var  //进入var文件夹
```

![](https://langwenchong.gitee.io/figure-bed/20210121185653.png)

我们可以看到有tmp和cache文件夹这两个可以尝试删除输入：

```
rm -rf tmp/* 
```

```
rm -rf cache/*
```

此时你应该就可以尝试重启了一般就可以正常启动了，如果还是无法启动，那么就尝试删除log文件夹中的文件直至能够重启，如果还不能那么就尝试删除其他文件夹下的log文件。

#### 目标三：成功重启虚拟机后进性磁盘扩展

首先恭喜如果你能够成功进入桌面啦😉，但是现在不要太早兴奋，因为现在你也只是进入桌面了，磁盘空间仍然是不够的，很有可能下次开机就又无法正常启动了。现在我们先将大部分文件导出，这里可以使用共享文件夹或者使用邮箱导出。然后你可以选择尝试对磁盘进行扩展或者重新装虚拟机了。如果你想对磁盘进行扩容的话那么就请参考这篇文件即可：[《根目录磁盘扩容》](https://blog.csdn.net/weixin_41018348/article/details/82592057)。如果你想重新装配虚拟机并且进行一条龙配置加美化请参考我的另一篇博客：[《ubuntu配置》](https://coolchong.cn/2021/01/22/ubuntu-problem2/)

### 💭总结

综上，我们对于本次错误进行了完美解决，我们反思发现其实就是空间分配不足了导致的图形化界面进程无法正常进行，再系统多次警示磁盘分区不足的情况后一定要及时处理不要一拖再拖。当然磁盘空间分区不足一方面是因为我们存储的文件太多了没有及时清除，另一方面就是在起初建立虚拟机时分配的空间太少了导致的，但是ubuntu的后期扩容又及其复杂不好操作，所以我也是强力推荐能够重装就重装虚拟机一次性分配够，因为vituralBox一开始默认分配的是10G硬盘空间肯定是不够的，所以我推荐重装虚拟机一次性开到足够大的空间一劳永逸😁。