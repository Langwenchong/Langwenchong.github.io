---
title: 计算机网络笔记--Part3
comments: false
top: false
date: 2021-03-27 19:35:05
tags: [note,408,计算机网络]
categories: 
	- [学习笔记]
	- [408,计算机网络]
---

本系列记录翀翀😛学习计算机组成原理的部分核心笔记，这部分是408最重要的部分，需要极大的毅力坚持学完，学习之前分享一句话与君共勉：你所有的迷茫，可能只是因为想得太多却做得太少。与其整日纠结，不如立即行动。也许不是每次出发都能找到正确的方向，不是每次尝试都能收获鲜花和掌声，但进一步自有进一步的欢喜。人生那么宝贵，既然渴望改变，就别畏首畏尾。

<!-- more -->

### 协议、接口和服务

#### 协议

协议是一些规则的集合。在网络中要做到有条不紊的交换数据，就必须遵循一些实现约定好的规则，这些规则明确规定了所交换的数据的格式和一些其他问题。这些为进行网络中的数据交换而建立的规则、标准和约定称为网络协议，他是控制两个或多个对等实体进行通信的规则的集合，是水平的。不定等实体之间是没有协议的，比如用TCP/IP协议栈通信的两个节点，节点A的传输层和节点B的传输层之间存在协议，但是节点A的传输层和节点B的网络层之间就不存在协议，网络协议也称为协议。

一个协议由语法、语义和同步三部分组成。语法规定了传输数据的格式，语义规定了所要完成的功能，即需要发出何种控制信息、完成何种动作以及做出何种应答，同步规定了执行各操作的条件、时序关系等，即事件实现顺序的详细说明。一个完整的协议通常应该具有线路管理（建立、释放连接）、差错控制。数据转转换等功能。

#### 接口

接口是同一节点内相邻两层之间交换信息的连接点，是一个系统内部的规定。每层只能相邻的两层之间定义接口，不能跨层定义接口，在典型的接口上，同一节点的相邻两层的实体通过服务访问点（SAP）进行交互。服务是通过SAP提供给上层使用的，第n层的SAP就是第n+1层可以访问第n层的地方。每一个SAP都有一个能够标识他的地址。SAP是一个抽象概念，他实际上是一个逻辑接口（类似于信箱），与通常所说的两个设备之间的接口是不同的，即使一个区域为接口，并不是实体上的“接口”。

#### 服务

服务是指下层为紧邻的上层提供的功能调用，他是垂直的，对等实体在协议的控制下，使得本层能为上一层提供服务，但要实现本层协议还需要下一层所提供的的服务。

上层使用下层所提供的服务时必须与下层交换一些指令，这些命令在OSI中称为服务原语，OSI服务原语可以分为下面四种：

- 请求（Request)：由服务用户发往服务提供者，请求完成某项工作。
- 指示（Indication)：由服务提供者发往服务用户，指示用户做某件事情。
- 响应（Response)：由服务用户发往服务提供者，作为对指示的响应。
- 证实（Confirmation)：由服务提供者发往服务用户，作为对请求的证实。

这四类原语用于不同的功能，如建立连接、传输数据和断开连接等，有应答服务包括全部4类原语，而无应答服务则只有请求和指示两类原语。我们用一个图来说明：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210327200618.png)

假设现在端系统A的n+1层向端系统Bn+1层进行了一个交换信息行为，那么n+1层需要先向n层发送请求，然后n层也一直向下发送请求直至物理层，然后物理层传输信号到达系统B的物理层再逐层向上传递指示。当端系统B的n+1层处理完信号以后，如果不需要响应，那么这次操作就完成了，否则B中的n+1层向n层发送响应，然后n层及以下层也是逐层向下发送响应，最后到达物理层通过传输到达系统A，再逐层向上传递证实。

{% note info, 

我们一定要注意服务是上下相邻层之间才能进行的，即n+1层只能使用第n的服务，他不能跨层使用。当原语传递到n层后，继续再向上或向下传递就是通过第n层使用n-1层的服务了。此时就和n+1层没有直接关系了。

%} 

##### 思考：协议、服务的区别？

注意协议和服务概念上不同。首先，只有本层协议的实现才能保证向上一层提供服务，本层的服务用户只能看见服务而无法看见下面的协议，即下面的协议对上层的服务是透明的而协议不透明。其次协议是水平的，协议是控制对等实体之间通信的规则，而服务时垂直的，服务是由下层通过层间接口向上层提供的。另外，并非在一层内完成的全部功能都称为服务，只有能够被高层实体”看得见“的功能才是服务。

协议、接口、服务的关系如下图：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210327201722.png)

接口就是实体n+1和实体n之间能够交换原语的通道。

#### 计算机网络提供的服务

##### 面向连接服务与无连接服务

面向连接服务中，通信前双方必须先建立连接，分配相应的资源（如缓冲区等），以保证通信能够正常进行，传输结束以后释放连接和占用的资源。这种服务可以分为连接建立，数据传输和连接释放三个阶段，比如TCP就是一种面向连接服务的协议。

在无连接服务中，通信前双方不需要先建立连接，需要发送数据时可以直接发送，把每个带有目的地址的包（报文分组）传送到线路上，有系统选定路线进行传输，这是一种不可靠的服务。这种服务被描述为“尽最大努力交付”，他并不保证通信的可靠性。例如IP、UDP等就是一种无连接服务的协议。

{% note info, 

我们可以总结出面向连接服务是一种可靠传输，而无连接服务是一种不可靠连接。

%} 

##### 可靠服务和不可靠服务

可靠服务就是指网络具有纠错、检错、应答进制，能够保证数据正确、可靠地传送到目的地。

不可靠服务是指网络只是尽量正确、可靠地传送，而不能保证数据正确、可靠地传输到目的地，是一种尽力而为的服务。

对于提供不可靠服务的网络，网络的正确性、可靠性应该由应用或者用户来保证。例如：用户收到信息后要判断信息是否正确，如果不正确，那么用户要把出错信息报告给信息的发送者，以便发送者进行纠正措施。通过用户的这些措施，可以把不可靠的服务变成可靠的服务。

{% note info, 

在一层内完成的全部功能并非都称为服务，只有那些能够被高一层实体“看得见”的功能才能成为服务。

%} 

##### 有应答服务和无应答服务

有应答服务是指接收方收到数据以后向发送方给出相应的应答，该应答有传输系统内部自动实现，而不由用户实现。所发送的应答既可以是肯定的应答也可以是否定应答，通常在接收到的数据有错误时发送否定应答。例如：文件传输服务就是一种有应答服务。

无应答服务是指接收方收到数据后不自动给出应答。若需要应答，则由高层实现，例如：对于www服务，客户端收到服务器发送的页面文件后不给出应答。

### ISO/OSI参考模型

我们在上一章中讲到计算机网络中会进行结构分层，这里就将以下网络体系的分层结构模型。第一种就是OSI参考模型。

OSI参考模型是由国际标准化组织（ISO）提出的网络体系结构模型，称为开放系统互联参考模型（OSI/RM），通常简称为OSI参考模型。OSI一共分为了7层，从下到上依次为物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。第三层统称为通信子网，他是为了联网而附加的通信设备，完成数据的传输功能，高三层统称为资源子网，它相当于计算机系统，完成数据的处理功能。而传输层承上启下。OSI参考模型如下图：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210328104559.png)

我们前面还讲过打包的过程和拆包的过程以及PDU和SDU的关系：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210328104706.png)

我们通过上图可以看到在传输时实际上只是一直在通信子网传输，只有发送端和接收端会涉及到资源子网的上三层。并且上四层之间貌似是通过协议直接进行的数据交换，但是实际上都是通过通信子网的下三层呈现一个U型方向传送实现的。

下面我们详细学习一下各个层的功能：

##### 物理层（Physical Layer)

物理层的传输单位是比特，任务是透明的传输比特流，功能是在物理媒体上为数据端设备透明地传输原始比特流。

###### 思考：什么是透明传输

透明传输是指不管是什么数据，都可以以一定的比特组合，在物理层链路上进行传送：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210328105401.png)

也就是说物理层可以承担传输所有数据的功能。

物理层主要是定义数据端设备（DTE）和数据通信设备（DCE）的物理与逻辑连接方法，所以物理层协议也称为物理层接口标准。由于在通信技术的早期阶段，通信规则称为规程，因此物理层协议也称为物理层规程。

物理层接口标准很多，如：EIA-232C、EIA/TIA RS-449、CCITT的X2.1等。下图表示了两个通信节点及它们间的一段通信链路，物理层主要研究以下内容：

![](https://gitee.com/Langwenchong/figure-bed/raw/master/20210328105903.png)

1. 通信链路与通信节点的链接需要一些电路接口，物理层规定了这些接口的一些参数，如机械形状和尺寸、交换电路的数量和排列等，例如：笔记本电脑上的网线接口，就是物理层规定的内容之一
2. 物理层也规定了通信链路上传输的信号的意义和电气特征。例如物理层规定信号A代表数字0，那么当节点要传输数字0时，就会发送信号A，当节点接收到A信号以后，就知道在自己接收到的实际上是数字0.

{% note info, 

注意传输信息所使用的一些物理媒介，如双绞线、光缆、无线信道等，并不在物理层协议之内而在物理层协议下面。因此物理媒体也常被称为第0层。

%} 

下面我们总结一下物理层的功能：

- 定义接口特性
- 定义传输模式（单工、半双工、双工）
- 定义传输速率
- 比特同步
- 比特编码

##### 数据链路层（Data Link Layer)

数据链路层的传输单位是帧，任务是将网络层传来的IP数据报组装成帧。数据链路层的功能可以概括为成帧、差错控制、流量控制和传输管理等。

由于外界噪声的干扰，原始的物理连接在传输比特流时可能发生错误：左边节点想向右边节点传输数字0，于是发送了信号A，但是由于传输过程中受到了干扰，信号A变成了限号B，而信号B又刚好代表1，右边节点接收到信号B时，就会误以为左边节点传送了数字1，从而发生差错。这种差错我们称之为信号翻转，即0变成了1,1变成了0，其实我们在学习了数字逻辑以后就知道导致这种现象的原因是电平电压受噪音干扰发生了波动导致的。此时我们需要通过适当的办法避免这种错误的干扰，于是两个节点之间如果规定了数据链路层协议，那么就可以检测出这些数据翻转的差错，然后把收到的错误信息丢弃，这就是差错控制功能。因此差错控制功能是通过数据链路层完成的。

同时，在两个相邻接点之间传送数据时，由于两个节点的性能不同，可能节点A发送数据速率会快于节点B接受数据的速率，如果不加以控制，那么节点B就会丢弃很多来不及接受的正确数据，造成传输线路效率的下降。流量控制可以协调两个节点的速率，使节点A发送数据的速率刚好是节点B可以接受到的速率。总之就是A节点发送数据的速率要小于等于节点B接受数据的速率。

广播式网络在数据链路层还要处理新的问题（快速跳转->[《广播式网络》](https://wenchong.space/2021/03/03/comnet-note1/)），即如何控制对共享信道的访问，数据链路层的一个特殊的子层--介质访问子层，就是专门处理这个问题的以保证公共信道不会出现信息传输冲突。

典型的数据链路层协议有SDLC,HDLC,PPP,STP和帧中继等。

下面我们总结一下数据链路层的功能：

- 成帧（定义帧的开始和结束）
- 差错控制
- 流量控制
- 访问（介入）控制

